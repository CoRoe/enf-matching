Just a number of scripts, mostly in *statu nascendi*.

# fm.py

Generates a video test file. The video signal mimics a light source whose
luminosity is proportional to the rectified current grid voltage recorded by a
camera with global shutter. The simulated grid voltage is slightly shifted to
simulate grid frequency changes.

The pattern of the frequency deviation is according to the following table:

```
    # Format: Duration (seconds), frequency deviation factor
    freq_deltas = (
        (20, +0.002),
        (20, -0.002),
        (30,  0.000),
        (30, -0.003),
        (20, +0.003)
    )
```

The idea is that the pattern should be recognisable when the video file
generated by `fm.py`is analysed by `flimmer`.

`ffmpeg` is able to overlay two videos. This feature can be used to create
test files for `flimmer`: Take an arbitrary video clip, mix it with a file
generated by `fm.py`, and check if `flimmer` is still able to detect the ENF
pattern.

![Signal generated by fm.py](../images/fm_signal_sim.png)


## Limitations

- Files always have a duration of 120 seconds.

- Currently simulates only global shutter, not rolling shutter.

# Test Files

`fm.py`was used to create the following files:

| File                   | Description                                  |
|------------------------|----------------------------------------------|
| enf-c128-1080x1920.mp4 | File with ENF signal pattern, res. 1080x1920 |
| enf-c128-720x1280.mp4  | File with ENF signal pattern, res. 1080x1920 |

They contain only the ENF pattern defined in `fm.py` and are intended to be
mixed to add an ENF signal to other videos.
